angular.module("ascentApp").controller("AccountController",function(a,b,c,d,e,f,g,h,i,j,k){a.account={},a.fake={},i.query(function(b){a.countries=b.countries}),a.create=function(b){b&&(k.set("email",a.account.userInfo.userName),h.create(a.account,function(a){d.location.href="/account/#/activate/"}))}}),angular.module("ascentApp").controller("AccountActivateController",function(a,b,c,d,e,f,g,h,i){a.account={},a.email=i.get("email")}),angular.module("ascentApp").controller("AccountActivationController",function(a,b,c,d,e,f,g,h,i){a.account={code:e.code,email:e.email},h.activate(a.account,function(a){d.location.href="/profile/#/edit"})}),angular.module("ascentApp").controller("BookingController",function(a,b,c,d,e,f,g,h,i,j,k,l){l.query(function(b){a.flights=b.requests,a.details=h("filter")(a.flights,{status:"!BOOKED"},!0)[0],a.selected=a.details.id}),a.show=function(b){l.get({id:b},function(c){a.selected=b,a.details=c})}}),angular.module("ascentApp").controller("CharterRequestController",function(a,b,c,d,e,f,g,h,h,i,j,k,l,m,n,o,p,q,r,s,t){s.get({id:h.id},function(b){a.charter=b,a.additional={},a.additional.id=a.charter.id,a.priceSwitch=a.priceDrop[0].code,q.get({id:a.charter.id},function(b){a.categories=b.categories}),p.query(function(b){a.baggage=b.baggageTypes})}),a.tooltipShown=!1,a.showTooltip=function(){a.tooltipShown=!0},a.hideTooltip=function(){a.tooltipShown=!1},a.signed=n.get("logged-in"),a.login={userName:"",password:""},a.priceDrop=[{code:"CHF",name:"Price (CHF)"},{code:"EUR",name:"Price (€)"},{code:"USD",name:"Price ($)"},{code:"GBP",name:"Price (£)"}],a.changePrice=function(b,c){a.priceSwitch=c},a.loginPopup=function(b){1==a.updateQuote.$valid&&(a.dialog=l.open({template:viewsPath+"views/account/modal.html",scope:a}))},a.popupInfo={title:"Title...",content:"Contents....",placement:"left"},a.processLogin=function(b){b&&k.login(a.login,function(b,d){n.put("logged-in",!0,{path:"/"}),n.put("JSESSIONID",d("SESSIONID"),{path:"/"}),n.put("user",b.userId,{path:"/"}),a.user={email:b.userName,id:b.userId},l.close(a.dialog.id),c(function(){t.get({id:b.userId},function(b){n.put("userMail",b.firstName+" "+b.lastName,{path:"/"}),c(function(){a.submit()},500)})},500)})},a.submit=function(){1==a.updateQuote.$valid&&1==e.get("logged-in")&&r.update(a.additional,function(b){f.location.replace("/request/#/overview/"+a.charter.id)})},AscentJet.switchSmallGallery(),a.showGalleryContainer=function(a,b){a.target.closest("div.images").hide(),a.target.closest("div.images").find(b).show()}}),angular.module("ascentApp").controller("EditAccountController",function(a,b,c,d,e,f,g,h,i,j){a.account={},a.saved=!1,j.query(function(b){a.countries=b.countries}),i.get({id:h.get("user")},function(b){a.account={customerId:parseInt(h.get("user")),customerInfo:{title:b.title,firstName:b.firstName,lastName:b.lastName,countryId:b.countryId,address:b.address,address2:b.address2,city:b.city,zipCode:b.zipCode}}}),a.update=function(){1==a.updateAccount.$valid&&i.save(a.account,function(b){i.get({id:h.get("user")},function(a){h.put("userMail",a.firstName+" "+a.lastName,{path:"/"})}),a.saved=!0})}}),angular.module("ascentApp").controller("EmptyController",function(a,b,c,d,e,f,g,h,i,j,k,l){a.query={legs:[{from:"",to:"",date:null,time:null,passengers:""}]},a["return"]=[{leg:!1}],a.addRow=function(){a.query.legs.push({from:"",to:"",date:null,time:null,passengers:""}),a["return"].push({leg:!1})},a["delete"]=function(b){a.query.legs.splice(a.query.legs.indexOf(b)),a["return"].splice(a["return"].indexOf(b))},a.request=function(){request={},request.legs=[],angular.forEach(a.query.legs,function(a,b){request.legs.push({from:a.from,to:a.to,date:h("date")(a.date,"dd/MM/yyyy"),time:h("date")(a.time,"HH:mm"),passengers:a.passengers})}),j.save(request,function(b){null!==b.id?(d.put("quote",b),e.location.href="/charter-request/"):a.noCharter=!0})},a.airportOptions={options:{html:!0,focusOpen:!1,onlySelectValid:!0,source:function(b,c){var d="";k.search({searchString:b.term},function(a){d=a}),data=a.airportOptions.methods.filter(d,b.term),c(data)}},methods:{}},a.activeTab="quote",a.switchTabTo=function(b){a.activeTab=b}}),angular.module("ascentApp").controller("EmptyRequestController",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){r.get({id:g.id},function(b){a.charter=b,a.additional={},a.additional.id=a.charter.id,a.priceSwitch=a.priceDrop[0].code,p.get({id:a.charter.id},function(b){a.categories=b.categories}),o.query(function(b){a.baggage=b.baggageTypes})}),a.signed=m.get("logged-in"),a.login={userName:"",password:""},a.gallery=!0,a.floorplan=!1,a.switchGallery=function(b){"gallery"==b?(a.gallery=!0,a.floorplan=!1):(a.gallery=!1,a.floorplan=!0)},a.priceDrop=[{code:"CHF",name:"Price (CHF)"},{code:"EUR",name:"Price (€)"},{code:"USD",name:"Price ($)"},{code:"GBP",name:"Price (£)"}],a.loginPopup=function(a){},a.loginPopup=function(b){1==a.updateQuote.$valid&&(a.dialog=j.open({template:viewsPath+"views/account/modal.html",scope:a}))},a.processLogin=function(b){b&&k.login(a.login,function(b,d){m.put("logged-in",!0,{path:"/"}),m.put("JSESSIONID",d("SESSIONID"),{path:"/"}),m.put("user",b.userId,{path:"/"}),a.user={email:b.userName,id:b.userId},j.close(a.dialog.id),c(function(){s.get({id:b.userId},function(b){m.put("userMail",b.firstName+" "+b.lastName,{path:"/"}),c(function(){a.submit()},500)})},500)})},a.submit=function(){1==a.updateQuote.$valid&&1==e.get("logged-in")&&q.update(a.additional,function(b){f.location.replace("/request/#/overview/"+a.charter.id)})},a.tooltipShown=!1,a.showTooltip=function(){a.tooltipShown=!0},a.hideTooltip=function(){a.tooltipShown=!1}}),angular.module("ascentApp").controller("ErrorController",function(a,b,c,d,e,f,g,h){a.request={},a.request.offerId=e.id,a.request.passengers=[{title:"Mr",firstName:"",lastName:"",passport:"",validMonth:"",validYear:""}],a.addRow=function(){a.request.passengers.push({title:"Mr",firstName:"",lastName:"",passport:"",validMonth:"",validYear:""})},a.submit=function(){h.create(a.request,function(a){d.location.href="/flights/booking/#/finish/"+e.id})}}),angular.module("ascentApp").controller("FinishController",function(a,b,c,d,e,f,g,h,i){h.save({id:e.id},function(b){a.offer=b,a.flightNO=b.tripRequestId,i.query({id:b.tripRequestId},function(b){a.flight=b})})}),angular.module("ascentApp").controller("LoginController",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){$reloadRoot=g.location.href,a.account={},a.login={userName:"",password:""},a.$watch(function(){return m.get("userMail")},function(){a.userMail=m.get("userMail")}),a.$watch(function(){return f.get("logged-in")},function(){1==f.get("logged-in")?a.showLogin=!1:a.showLogin=!0}),a.create=function(){a.loginForm.$valid&&k.login(a.login,function(b,c){m.put("logged-in",!0,{path:"/"}),m.put("JSESSIONID",c("SESSIONID"),{path:"/"}),m.put("user",b.userId,{path:"/"}),a.user={email:b.userName,id:b.userId},l.get({id:m.get("user")},function(a){m.put("userMail",a.firstName+" "+a.lastName,{path:"/"}),g.location.href=$reloadRoot})})},a.logout=function(){n.logout({},function(a,b){m.put("logged-in",!1,{path:"/"}),m.remove("JSESSIONID",!1,{path:"/"}),m.remove("user",!1,{path:"/"}),m.remove("userMail",!1,{path:"/"}),g.location.href="/"})}}),angular.module("ascentApp").controller("LogoutController",function(a,b,c,d,e,f,g,h,i,j){i.logout({},function(a,b){j.put("logged-in",!1,{path:"/"}),j.remove("JSESSIONID",!1,{path:"/"}),j.remove("user",!1,{path:"/"}),e.location.href="/"})}),angular.module("ascentApp").controller("OfferSubmitController",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){e.scrollTo(0,0),a.charter=i.get("quote"),m.get({id:f.id},function(b){a.flight=b,k.get({id:a.flight.id},function(b){a.categories=b.categories})}),a.save=function(){n.save({id:f.id},function(a){e.location.href="/request/#/success/"+f.id})}}),angular.module("ascentApp").controller("OfferSuccessSubmitController",function(a,b,c,d,e,f,g,h,i,j,k,l,m){a.charter={},a.charter.id=f.id,a.submit=function(){l.update(a.additional,function(a){e.location.href="/request-for-offer/"})}}),angular.module("ascentApp").controller("PaidController",function(a,b,c,d,e,f,g,h,i){a.offer={},a.offer.id=e.id,i.save({id:a.offer.id},function(b){a.requestId=b.tripRequestId})}),angular.module("ascentApp").controller("PassangersController",function(a,b,c,d,e,f,g,h){a.request={},a.request.offerId=e.id,a.request.passengers=[{title:"Mr",firstName:"",lastName:"",passport:"",validMonth:"",validYear:""}],a.remove=function(b){var c=a.request.passengers.indexOf(b);a.request.passengers.splice(c,1)},a.addRow=function(){a.request.passengers.push({title:"Mr",firstName:"",lastName:"",passport:"",validMonth:"",validYear:""})},a.submit=function(b){b&&h.create(a.request,function(a){d.location.href="/flights/booking/#/finish/"+e.id})}}),angular.module("ascentApp").controller("PasswordController",function(a,b,c,d,e,f,g,h){a.account={},a.send=function(b){b&&h.save(a.account,function(b){a.response=b,d.location.href="/account/#/password-changed"})}}),angular.module("ascentApp").controller("SearchController",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){var t=k.path(),u=g.location.pathname;a.cleared=!0,"/"==u?a.home=!0:a.home=!1,a.empty={airportFrom:"",airportTo:"",airportFromF:"",airportToF:"",flightStart:null,time:null,passengers:null,page:1,pageSize:5},"/get-a-quote/"==u&&(a.empty=null!=l.get("emptyLegQueryInfo")?l.get("emptyLegQueryInfo"):a.empty,(request=null!=l.get("emptyLegQuery"))?(request=l.get("emptyLegQuery"),a.cleared=!1):request={page:1,pageSize:10},m.save(request,function(b){l.set("emptyLegQuery",null),l.set("emptyLegQueryInfo",null),a.emptyResults={},a.emptyResults.count=b.count,a.emptyResults.legs=[],angular.forEach(b.legs,function(b,c){var d=new google.maps.LatLngBounds;d.extend(new google.maps.LatLng(b.airportFromObj.latitude,b.airportFromObj.longitude)),d.extend(new google.maps.LatLng(b.airportToObj.latitude,b.airportToObj.longitude)),center=d.getCenter(),obj=b,obj.markers=[],obj.bounds={},obj.line={},obj.bounds.northeast={longitude:b.airportFromObj.longitude,latitude:b.airportFromObj.latitude},obj.bounds.southwest={longitude:b.airportToObj.longitude,latitude:b.airportToObj.latitude},obj.markers.push({longitude:b.airportFromObj.longitude,latitude:b.airportFromObj.latitude,id:0,icon:"/media/static/images/marker.png"}),obj.markers.push({longitude:b.airportToObj.longitude,latitude:b.airportToObj.latitude,id:1,icon:"/media/static/images/marker.png"}),obj.marker={icon:{url:"/media/static/images/marker.png",origin:new google.maps.Point(0,0),anchor:new google.maps.Point(12,12)}},obj.map={center:{latitude:center.lat(),longitude:center.lng()},zoom:14,control:{},bounds:{},visible:!1,pan:!0},obj.line={id:1,path:[{latitude:b.airportFromObj.latitude,longitude:b.airportFromObj.longitude},{longitude:b.airportToObj.longitude,latitude:b.airportToObj.latitude}],stroke:{color:"#323a45",weight:3},visible:!0},a.emptyResults.legs.push(obj)})})),a.emptyLegSearch=function(){l.set("emptyLegQuery",null),l.set("emptyLegQueryInfo",null),g.location.href="/get-a-quote/#/empty"},a.clearSearch=function(){$("#empty-legs-form").removeClass("ng-submitted"),a.cleared=!0,a.empty={},m.save({page:1,pageSize:10},function(b){a.emptyResults={},a.emptyResults.count=b.count,a.emptyResults.legs=[],angular.forEach(b.legs,function(b,c){var d=new google.maps.LatLngBounds;d.extend(new google.maps.LatLng(b.airportFromObj.latitude,b.airportFromObj.longitude)),d.extend(new google.maps.LatLng(b.airportToObj.latitude,b.airportToObj.longitude)),center=d.getCenter(),obj=b,obj.markers=[],obj.bounds={},obj.line={},obj.bounds.northeast={longitude:b.airportFromObj.longitude,latitude:b.airportFromObj.latitude},obj.bounds.southwest={longitude:b.airportToObj.longitude,latitude:b.airportToObj.latitude},obj.markers.push({longitude:b.airportFromObj.longitude,latitude:b.airportFromObj.latitude,id:0,icon:"/media/static/images/marker.png"}),obj.markers.push({longitude:b.airportToObj.longitude,latitude:b.airportToObj.latitude,id:1,icon:"/media/static/images/marker.png"}),obj.marker={icon:{url:"/media/static/images/marker.png",origin:new google.maps.Point(0,0),anchor:new google.maps.Point(12,12)}},obj.map={center:{latitude:center.lat(),longitude:center.lng()},zoom:14,control:{},bounds:{},visible:!1,pan:!0},obj.line={id:1,path:[{latitude:b.airportFromObj.latitude,longitude:b.airportFromObj.longitude},{longitude:b.airportToObj.longitude,latitude:b.airportToObj.latitude}],stroke:{color:"#323a45",weight:3},visible:!0},a.emptyResults.legs.push(obj)})})},a.url=u,a.dateOptions={minDate:0,firstDay:1,dateFormat:"dd-mm-yy"},a.query={returnFlight:!1,legs:[{from:"",to:"",fromF:"",toF:"",date:null,time:null,passengers:null}]},a["return"]=[{leg:!1}],a.addRow=function(){$("#charter-quote-form").removeClass("ng-submitted"),a.query.legs.push({from:"",to:"",fromF:"",toF:"",date:null,time:null,passengers:""})},a.remove=function(b){var c=a.query.legs.indexOf(b);a.query.legs.splice(c,1),1==a.query.returnFlight&&1==c&&(a.query.returnFlight=!1)},a.request=function(b){b&&(request={},request.legs=[],request.returnFlight=a.query.returnFlight,angular.forEach(a.query.legs,function(a,b){request.legs.push({from:a.from,to:a.to,date:j("date")(a.date,"dd/MM/yyyy"),time:j("date")(a.time,"HH:mm"),passengers:a.passengers})}),o.save(request,function(b){null!==b.id?g.location.href="/request/#/charter/"+b.id:a.noCharter=!0}))},a.returnFlight=function(){a.query.legs[1].from=a.query.legs[0].to,a.query.legs[1].to=a.query.legs[0].from},a.$watch("query.returnFlight",function(b){1==b&&a.query.legs.length>2&&a.query.legs.splice(2,5)}),a.emptyRequest=function(a){n.request({id:a.id},{},function(a){g.location.href="/request/#/empty-leg/"+a.tripRequestId})},a.emptySearch=function(b){b&&(a.cleared=!1,request={airportFrom:a.empty.airportFrom,airportTo:a.empty.airportTo,flightStart:j("date")(a.empty.flightStart,"yyyy-MM-dd"),page:1,pageSize:10},"/"==u?(l.set("emptyLegQuery",request),l.set("emptyLegQueryInfo",a.empty),g.location.href="/get-a-quote/#/empty"):m.save(request,function(b){a.emptyResults={},a.emptyResults.count=b.count,a.emptyResults.legs=[],angular.forEach(b.legs,function(b,c){var d=new google.maps.LatLngBounds;d.extend(new google.maps.LatLng(b.airportFromObj.latitude,b.airportFromObj.longitude)),d.extend(new google.maps.LatLng(b.airportToObj.latitude,b.airportToObj.longitude)),center=d.getCenter(),obj=b,obj.markers=[],obj.bounds={},obj.line={},obj.bounds.northeast={longitude:b.airportFromObj.longitude,latitude:b.airportFromObj.latitude},obj.bounds.southwest={longitude:b.airportToObj.longitude,latitude:b.airportToObj.latitude},obj.markers.push({longitude:b.airportFromObj.longitude,latitude:b.airportFromObj.latitude,id:0,icon:"/media/static/images/marker.png"}),obj.markers.push({longitude:b.airportToObj.longitude,latitude:b.airportToObj.latitude,id:1,icon:"/media/static/images/marker.png"}),obj.marker={icon:{url:"/media/static/images/marker.png",origin:new google.maps.Point(0,0),anchor:new google.maps.Point(12,12)}},obj.map={center:{latitude:center.lat(),longitude:center.lng()},zoom:14,control:{},bounds:{},visible:!1,pan:!0},obj.line={id:1,path:[{latitude:b.airportFromObj.latitude,longitude:b.airportFromObj.longitude},{longitude:b.airportToObj.longitude,latitude:b.airportToObj.latitude}],stroke:{color:"#323a45",weight:3},visible:!0},a.emptyResults.legs.push(obj)})}))},a.airportOptions={options:{html:!0,focusOpen:!0,onlySelectValid:!0,source:function(a,b){var c="";p.search({searchString:a.term},function(a){c=a.airports,c=[],angular.forEach(a.airports,function(a){var b=[];""!=a.airportName.trim()&&b.push(a.airportName),""!=a.iataCode.trim()&&b.push(a.iataCode),c.push({label:a.city+", "+a.country+" ("+b.join("/")+")",value:a.city+", "+a.country+" ("+b.join("/")+")",code:a.code})}),b(c)})},select:function(b,c){var d=$(b.target),e=d.data("index");"from"==d.data("target")?a.query.legs[e].from=c.item.code:"to"==d.data("target")?a.query.legs[e].to=c.item.code:"airportFrom"==d.data("target")?a.empty.airportFrom=c.item.code:"airportTo"==d.data("target")&&(a.empty.airportTo=c.item.code)}},methods:{}},"/get-a-quote/"==u&&(a["class"]="blue"),a.activeTab="/empty"==t?"empty":"quote",a.switchTabTo=function(b){a.activeTab=b},a.selected="-1",a.select=function(b){a.selected=b},f(function(){a.map={center:{latitude:51.219053,longitude:4.404418},zoom:14,control:{},bounds:{},window:{marker:{},show:!1,closeClick:function(){this.show=!1},options:{}},infoWindowWithCustomClass:{coords:{latitude:51.219053,longitude:4.404418},options:{boxClass:"custom-info-window",closeBoxDiv:'<div" class="pull-right" style="position: relative; cursor: pointer; margin: -20px -15px;">X</div>',disableAutoPan:!0,visible:!0},show:!0}}},100),a.options={scrollwheel:!1,maxZoom:12},a.windowOptions={visible:!0},a.onClick=function(){a.windowOptions.visible=!a.windowOptions.visible},a.closeClick=function(){a.windowOptions.visible=!1},a.aircraftSearch={},f(function(){q.then(function(b){a.map.window.options.pixelOffset=new google.maps.Size(100,100,"px","px")})},100),a.countries=[],a.countryConfig={sortField:"name",maxItems:1,allowEmptyOption:!0,valueField:"id",labelField:"name"},a.addresses=[],a.refreshCountries=function(b){s.query(function(b){a.countries=b.countries})},a.markers=[],a.airportSearch=function(){p.search(a.aircraftSearch,function(b){a.markers=[],angular.forEach(b.airports,function(b,c){a.markers.push({longitude:b.longitude,latitude:b.latitude,id:c,title:b.city+", "+b.country+"("+b.code+")",icon:"/media/static/images/marker.png"})}),1==a.markers.length&&(a.map.zoom=14)})},a.showDetails=function(b,c){$this=$(b.target),$this.closest("tr").toggleClass("expanded"),$this.closest("tr").find("div.btn").toggle(),a.emptyResults.legs[c].map.visible=!0,$this.parents("tr").next().find("div.expander").slideToggle(function(){$this.parents("tr").next().find("div.map").css({display:"block"}),$this.parents("tr").next().find("div.expander").find("slick").get(0).slick.setPosition()}),AscentJet.switchGallery()},a.showDetailsMobile=function(a,b){$this=$(a.target),$this.prev("div.extra").slideToggle(),AscentJet.switchMobileGallery(),$this.prev("div.extra").find("slick").get(0).slick.setPosition(),$this.parent().toggleClass("active"),$this.parent().hasClass("active")?$this.text($this.data("close")):$this.text($this.data("details"))},a.single=null,a.singleConfig={options:[{value:1,text:"1"},{value:2,text:"2"},{value:3,text:"3"},{value:4,text:"4"}],sortField:"text",maxItems:1}}).directive("scrollTo",["ScrollTo",function(a){return{restrict:"AC",compile:function(){return function(b,c,d){c.bind("click",function(b){a.idOrName(d.scrollTo,d.offset)})}}}}]).service("ScrollTo",["$window","ngScrollToOptions",function(a,b){this.idOrName=function(c,d,e){var f=a.document,g=f.getElementById(c);g&&(e&&g.focus(),b.handler(g,d))}}]).provider("ngScrollToOptions",function(){this.options={handler:function(a,b){if(b){var c=$(a).offset().top-b;window.scrollTo(0,c)}else a.scrollIntoView()}},this.$get=function(){return this.options},this.extend=function(a){this.options=angular.extend(this.options,a)}}).directive("resize",function(a,b){return function(b,c){var d=angular.element(a);b.getWindowDimensions=function(){return{h:d.height(),w:d.width()}},b.$watch(b.getWindowDimensions,function(a,c){b.windowHeight=a.h,b.windowWidth=a.w,b.style=function(){return{height:a.h-100+"px",width:a.w-100+"px"}}},!0),d.bind("resize",function(){b.$apply()})}});